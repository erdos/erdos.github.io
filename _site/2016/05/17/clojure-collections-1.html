<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Clojure collection quirks - Vectors</title>
  <meta name="description" content="Working with Clojure collections is a pleasure. Yet, sometimes one may run into unexpected behaviors. In this series, we take a look at the most simple Cloju...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://erdos.github.io/2016/05/17/clojure-collections-1.html">
  <link rel="alternate" type="application/rss+xml" title="personal web site of janos erdos" href="http://erdos.github.io/feed.xml">
  <script src="/js/turbolinks.js"></script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-78062302-1', 'auto');
  ga('send', 'pageview');

  document.addEventListener("turbolinks:load", function() {
    ga('send', 'pageview', window.location.pathname);
  });
  </script>
</head>


  <body>
    <section id="A">
  <div>
    <!--<a id="Logo" href="/">personal web site of janos erdos</a>-->
    <nav class="M">
      <a href="/">Blog</a>
      
      
      <a href="/about/">About</a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
    </nav>


  </div>
</section>

    <div id="main">
      <div>
        <article class="post" itemscope>
  <header>
    <h1><a href="/2016/05/17/clojure-collections-1.html">Clojure collection quirks - Vectors</a></h1>
  </header>
  <br/>
  <div>
    <p>Working with Clojure collections is a pleasure. Yet, sometimes one may run into unexpected behaviors. In this series, we take a look at the most simple Clojure data structures.</p>

<h2 id="vectors">Vectors</h2>

<p>Vectors are sequential collections with constant time random access capability.</p>

<p>One can also view vectors as integer to element mappings. Examples:</p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="k">def</span><span class="w"> </span><span class="n">v1</span><span class="w"> </span><span class="p">[</span><span class="no">:zero</span><span class="w"> </span><span class="no">:one</span><span class="w"> </span><span class="no">:two</span><span class="w"> </span><span class="no">:three</span><span class="p">])</span><span class="w">

</span><span class="p">(</span><span class="nb">get</span><span class="w"> </span><span class="n">v1</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">=&gt;</span><span class="w"> </span><span class="no">:one</span><span class="w">
</span><span class="p">(</span><span class="nb">find</span><span class="w"> </span><span class="n">v1</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="no">:one</span><span class="p">]</span></code></pre></figure>

<h3 id="functions">Functions</h3>

<p>Vectors also act like functions (they implement the <code class="highlighter-rouge">clojure.lang.IFn</code> interface):</p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="nf">v1</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">=&gt;</span><span class="w"> </span><span class="no">:one</span></code></pre></figure>

<p>But be aware not to index out of bounds.</p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="nf">v1</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="n">=&gt;</span><span class="w"> </span><span class="n">IndexOutOfBoundsException!!!</span></code></pre></figure>

<p>To avoid IOBE you should use the <code class="highlighter-rouge">(get)</code> function. You can also add a default value that is returned when the given index is not in the vector.</p>

<h3 id="modify">Modify</h3>

<p>We can also modify an item on an index of a vector:</p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="nb">assoc</span><span class="w"> </span><span class="n">v1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="no">:One</span><span class="p">)</span><span class="w"> </span><span class="n">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="no">:zero</span><span class="w"> </span><span class="no">:One</span><span class="w"> </span><span class="no">:two</span><span class="w"> </span><span class="no">:three</span><span class="p">]</span></code></pre></figure>

<p>Thatâ€™s right, one can change an item on an index of a vector just like with a map.</p>

<p>How is about removing an item from a vector?</p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="nb">dissoc</span><span class="w"> </span><span class="n">v1</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">=&gt;</span><span class="w"> </span><span class="n">ClassCastException!!</span></code></pre></figure>

<p>You can not call <code class="highlighter-rouge">dissoc</code> on a vector because that could not remove an item without affecting the indices of all other items after the given index. To remove an item, first you need to split the vector into two parts (calling <code class="highlighter-rouge">subvec</code>) and then create a vector from the concatenation of the result.</p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="k">defn</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="p">[</span><span class="n">v</span><span class="w"> </span><span class="nb">index</span><span class="p">]</span><span class="w">
  </span><span class="p">(</span><span class="nf">vec</span><span class="w"> </span><span class="p">(</span><span class="nb">concat</span><span class="w"> 
    </span><span class="p">(</span><span class="nb">subvec</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nb">index</span><span class="p">)</span><span class="w"> 
    </span><span class="p">(</span><span class="nb">subvec</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="p">(</span><span class="nb">inc</span><span class="w"> </span><span class="nb">index</span><span class="p">)))))</span></code></pre></figure>

<h3 id="as-queues">As Queues</h3>

<p>Vectors are often used as queues. The <code class="highlighter-rouge">conj</code> function appends a value to the end of the vector. The <code class="highlighter-rouge">peek</code> function returs the last item of the vector in constant time. (The <code class="highlighter-rouge">last</code> function is linear time thus much slower usually.) The <code class="highlighter-rouge">pop</code> function drops the last item from a vector.</p>


  </div>
</article>
<footer>
  <nav>
    <a href="#" class="outline">Top of page</a>
    <a href="http://erdos.github.io" class="outline">Home</a>
  </nav>
</footer>

      </div>
    </div>
    <footer>
</footer>

  </body>

</html>
